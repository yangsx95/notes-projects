<html>
  <head>
    <meta charset="UTF-8">
    <title>4. Day04 - Gaiden</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css\bootstrap.min.css">
    <link rel="stylesheet" href="css\font-awesome.min.css">
    <link rel="stylesheet" href="css\highlight.css">
    <link rel="stylesheet" href="css\style.css">
    <link rel="stylesheet" href="css\my.css">
  </head>
  <body>
    <div class="wrapper">
      <div class="header">
        <i class="fa fa-bars sidebar-toggle"></i>
        <span class="title"><a href="Day01.html">Gaiden</a></span>
      </div>
      <div class="sidebar">
        <ul>
          <li class="numbered visible">
            <a href="Day01.html" data-alt-hash="day01"><span class="number">1.</span>Day01</a>
            <ul>
              <li class="numbered visible">
                <a href="Day01.html#id-7162f5a11c8e3a956d9aa4ee917bff96000fbc98"><span class="number">1.1.</span>任务详细说明</a>
                <ul>
                  <li class="numbered visible"><a href="Day01.html#mvc"><span class="number">1.1.1.</span>创建项目按照MVC的架构模式创建相应的包结构如下图：</a></li>
                  <li class="numbered visible"><a href="Day01.html#pomxml"><span class="number">1.1.2.</span>pom.xml的依赖配置：</a></li>
                  <li class="numbered visible"><a href="Day01.html#hibernatehibernatecfgxml"><span class="number">1.1.3.</span>配置hibernate的主配置文件:hibernate.cfg.xml</a></li>
                  <li class="numbered visible"><a href="Day01.html#hibernate"><span class="number">1.1.4.</span>根据分析创建实体，并做hibernate的映射，根据需求文档的物理设计</a></li>
                  <li class="numbered visible"><a href="Day01.html#hibernatesession"><span class="number">1.1.5.</span>hibernate的session工具类</a></li>
                  <li class="numbered visible"><a href="Day01.html#id-95d0a5f0a237ffc3bd210b185d1403a7d5bd0b0b"><span class="number">1.1.6.</span>通过过滤器设置请求和回应编码以及权限控制</a></li>
                  <li class="numbered visible"><a href="Day01.html#bean"><span class="number">1.1.7.</span>为了解除各层之间的耦合性，提供一个bean工厂，来实现解耦合，</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="numbered visible">
            <a href="Day02.html" data-alt-hash="day02"><span class="number">2.</span>Day02</a>
            <ul>
              <li class="numbered visible">
                <a href="Day02.html#id-af156bad56b1c2a8dd04f104684a49eb3d4746d7"><span class="number">2.1.</span>任务详情说明</a>
                <ul>
                  <li class="numbered visible"><a href="Day02.html#id-d4579bbd2acc523dc6247c6313a2eb938ed40b41"><span class="number">2.1.1.</span>视图层:</a></li>
                  <li class="numbered visible"><a href="Day02.html#id-16a5af49bb761ed22ec9795aa5db3ab2509b2fb5"><span class="number">2.1.2.</span>控制层：</a></li>
                  <li class="numbered visible"><a href="Day02.html#id-bd5a39d61fc4d09c931d2b4d375ed25242ae7146"><span class="number">2.1.3.</span>业务层：</a></li>
                  <li class="numbered visible"><a href="Day02.html#id-63f45e92b7c574a974500c309a10d022ad4c2dfc"><span class="number">2.1.4.</span>数据访问层</a></li>
                  <li class="numbered visible"><a href="Day02.html#id-9847283c8e82f7ef2487ee4d3f3e94020aa37b1f"><span class="number">2.1.5.</span>商品首页的显示</a></li>
                  <li class="numbered visible"><a href="Day02.html#id-07cce4c07eab88c6b2d963af79a17ab00acd87cb"><span class="number">2.1.6.</span>图书的分类查询：</a></li>
                  <li class="numbered visible"><a href="Day02.html#id-1e90f40b7b77f956fa693e906060db7af1e670c8"><span class="number">2.1.7.</span>商品详情页：</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="numbered visible">
            <a href="Day03.html" data-alt-hash="day03"><span class="number">3.</span>Day03</a>
            <ul>
              <li class="numbered visible">
                <a href="Day03.html#id-914140ee94022822a51225fd8f39e9a54d6f79e5"><span class="number">3.1.</span>任务详情说明</a>
                <ul>
                  <li class="numbered visible"><a href="Day03.html#id-2a7ae62eb10734335d176e0235a52d41b1fab0fc"><span class="number">3.1.1.</span>功能设计</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="numbered visible">
            <a href="Day04.html" data-alt-hash="day04"><span class="number">4.</span>Day04</a>
            <ul>
              <li class="numbered visible">
                <a href="Day04.html#id-a1f28bf4e37b3b38d040c0438a82b4adb42e90a9"><span class="number">4.1.</span>任务详情说明</a>
                <ul>
                  <li class="numbered visible">
                    <a href="Day04.html#id-eebd10b9ea0ed96f1e7f9d66f2d9ddaefcabea4e"><span class="number">4.1.1.</span>功能设计</a>
                    <ul>
                      <li class="numbered invisible">
                        <a href="Day04.html#id-e1703107bce8a40037a8f02bf904265ad6136b82"><span class="number">4.1.1.1.</span>后台服务程序处理：</a>
                        <ul>
                          <li class="unnumbered invisible"><a href="Day04.html#id-db1624598f0a892a82cf7a24b3c9dd669a25f64c">购物车页面如下：</a></li>
                          <li class="unnumbered invisible"><a href="Day04.html#id-ce7b674841625c853dd4a98d8722a6d85252eaa0">购物车业务层接口定义：</a></li>
                          <li class="unnumbered invisible"><a href="Day04.html#id-3c7430c3a8cbc9fa43438c6534596d71a20c6c32">参考实现：</a></li>
                          <li class="unnumbered invisible"><a href="Day04.html#id-641946fb95fb38bf7525d2d10ec27e3ee682dddf">控制层：</a></li>
                          <li class="unnumbered invisible"><a href="Day04.html#jsp">JSP页面</a></li>
                          <li class="unnumbered invisible"><a href="Day04.html#id-ed6c5112aa07b28edbeee6bdd8d145ec6455b893">页面视图展示：</a></li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="numbered visible">
            <a href="Day05.html" data-alt-hash="day05"><span class="number">5.</span>Day05</a>
            <ul>
              <li class="numbered visible">
                <a href="Day05.html#id-5053eee6be99caad723b2f22524c1e2addfee6e9"><span class="number">5.1.</span>任务详细说明：</a>
                <ul>
                  <li class="numbered visible"><a href="Day05.html#id-2a4b9f847b652c5d8aed18c9d80398b917dab9c7"><span class="number">5.1.1.</span>功能设计</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="numbered visible">
            <a href="Day06.html" data-alt-hash="day06"><span class="number">6.</span>Day06</a>
            <ul>
              <li class="numbered visible">
                <a href="Day06.html#id-8de5978d4021ae9620176dbd1451f544ff8f798e"><span class="number">6.1.</span>任务单详细说明：</a>
                <ul>
                  <li class="numbered visible"><a href="Day06.html#id-4c4580cc53ffa82ec1a481ce14f72537efb100ee"><span class="number">6.1.1.</span>功能设计</a></li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </div>
      <div class="content">
        <div class="content-handle"></div>
        <div class="content-container">
          <div class="content-nav content-nav-top">
            <a class="prev-page" href="Day03.html">
            <i class="fa fa-angle-left"></i>
            <span class="number">3.</span>
            Day03
            </a>
            <a class="next-page" href="Day05.html">
            <span class="number">5.</span>
            Day05
            <i class="fa fa-angle-right"></i>
            </a>
          </div>
          <div class="page-toc">
            <ul>
              <li class="numbered visible">
                <a href="#day04"><span class="number">4.</span>Day04</a>
                <ul>
                  <li class="numbered visible">
                    <a href="#id-a1f28bf4e37b3b38d040c0438a82b4adb42e90a9"><span class="number">4.1.</span>任务详情说明</a>
                    <ul>
                      <li class="numbered visible">
                        <a href="#id-eebd10b9ea0ed96f1e7f9d66f2d9ddaefcabea4e"><span class="number">4.1.1.</span>功能设计</a>
                        <ul>
                          <li class="numbered visible">
                            <a href="#id-e1703107bce8a40037a8f02bf904265ad6136b82"><span class="number">4.1.1.1.</span>后台服务程序处理：</a>
                            <ul>
                              <li class="unnumbered visible"><a href="#id-db1624598f0a892a82cf7a24b3c9dd669a25f64c">购物车页面如下：</a></li>
                              <li class="unnumbered visible"><a href="#id-ce7b674841625c853dd4a98d8722a6d85252eaa0">购物车业务层接口定义：</a></li>
                              <li class="unnumbered visible"><a href="#id-3c7430c3a8cbc9fa43438c6534596d71a20c6c32">参考实现：</a></li>
                              <li class="unnumbered visible"><a href="#id-641946fb95fb38bf7525d2d10ec27e3ee682dddf">控制层：</a></li>
                              <li class="unnumbered visible"><a href="#jsp">JSP页面</a></li>
                              <li class="unnumbered visible"><a href="#id-ed6c5112aa07b28edbeee6bdd8d145ec6455b893">页面视图展示：</a></li>
                            </ul>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
          <div class="main-content">
            <h1 id="day04"><span class="number">4.</span>Day04</h1>
            <h2 id="id-a1f28bf4e37b3b38d040c0438a82b4adb42e90a9"><span class="number">4.1.</span>任务详情说明</h2>
            <p>此任务书需要项目经理利用半天的时间讲解整个购物车的需求，然后学生利用半天完成 购物车中商品的添加</br></p>
            <h3 id="id-eebd10b9ea0ed96f1e7f9d66f2d9ddaefcabea4e"><span class="number">4.1.1.</span>功能设计</h3>
            <p>此功能在商品的详情页面点击订购按钮，把要买的商品加入到自己的购物车中：</br> 此功能是利用ajax提交添加请求，请求成功，后台返回数据，然后在页面的此处</br> <img src="../img/212.png" alt="购物车"/>显示购物车中商品数量和总价格。</br></p>
            <h4 id="id-e1703107bce8a40037a8f02bf904265ad6136b82"><span class="number">4.1.1.1.</span>后台服务程序处理：</h4>
            <p><img src="../img/215.png" alt="购物车"/></br> IShopping.java购物车接口</br> MemorCart.java购物车实现</br> <span style="color:red">在此强调，以上的图示只是一个参考，你完全可以自行定义一个任意的Action</span></br></p>
            <h5 id="id-db1624598f0a892a82cf7a24b3c9dd669a25f64c">购物车页面如下：</h5>
            <p><img src="../img/214.png" alt="购物车"/></br></p>
            <h5 id="id-ce7b674841625c853dd4a98d8722a6d85252eaa0">购物车业务层接口定义：</h5>
            <pre><code class="java">public interface IShoppingCart {
    // 添加到购物车
	void addCart(OrderItem item);

	// 清空购物车
	void clear();

	// 修改数量
	void modifyCount(Long bookId, int count);

	// 删除某个条目
	void delete(Long bookId);

	// 获取总价
	double getTotal();

	// 获取商品数量
	int getCount();
	
	//获取购物车数据
	Map&lt;Long, OrderItem&gt; getItems();
	
	//获取购物车的商品详情
	OrderItem find(Long bookId);
	
}
</code></pre>
            <h5 id="id-3c7430c3a8cbc9fa43438c6534596d71a20c6c32">参考实现：</h5>
            <pre><code class="java">public class MemoryCart implements IShoppingCart {

    //属性
	private Map&lt;Long, OrderItem&gt; items = new HashMap&lt;&gt;();
	private double total; //总费用
	private int count; //商品总数量
	
    ....

}
</code></pre>
            <p>以上只给出这个实现的属性定义，所有的方法请自行根据业务来实现，如果不理解已上三个属性， 请找项目经理沟通。 <span style="color:red">注：Map中的Key类型，不一定是Long，请根据你的OrderItem实体类的id类型来定义。</span></br> <span style="color:red">由于此业务所需要的数据无需固化到数据库中或文件中，所以，此业务中无需提供Dao层。</span></br></p>
            <h5 id="id-641946fb95fb38bf7525d2d10ec27e3ee682dddf">控制层：</h5>
            <pre><code class="java">WebServlet(urlPatterns = &quot;/cart/*&quot;)
public class CartAction extends HttpServlet {

    /**
	 * 
	 */
	private static final long serialVersionUID = -8315374505680816746L;
	/** 业务接口 */
	private IShoppingCart shoppingCart;
	private IBookService bookService;
	/** 请求URL资源常量 */
	private static final String _SHOPPING = &quot;/addCartAjax&quot;;// 添加到购物车
	private static final String _TO_SHOPPINGCART = &quot;/showcart&quot;;// 查看购物车
	private static final String _MODIFYCART = &quot;/modifyCartAjax&quot;;// 修改商品数量
	private static final String _REMOVE_CART = &quot;/removeCartAjax&quot;;// 删除商品
	private static final String _CLEAR_CART = &quot;/clearCartAjax&quot;;// 清空购物车

	public CartAction() {
		super();
		this.shoppingCart = (IShoppingCart) BeanFactory.getBean(&quot;cartService&quot;);
		this.bookService = (IBookService) BeanFactory.getBean(&quot;bookService&quot;);
	}

	@Override
	protected void service(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
            
	.....
    ....
}
</code></pre>
            <p><span style="color:red">注：以上的代码片段只是一个参考，如果没有读懂的话，可以与项目经理沟通</span></br></p>
            <h5 id="jsp">JSP页面</h5>
            <p>1.请根据原型自行开发，需要使用EL表达式和JSTL标签。</br> 2.在页面需要开发很多的JS脚本，比如涉及到DOM操作，AJAX操作，请自行完成。</br> 3.页面请求的URL应该与你的控制器的映射保持一致。</br> 4.完成测试的测试。</br></p>
            <h5 id="id-ed6c5112aa07b28edbeee6bdd8d145ec6455b893">页面视图展示：</h5>
            <p><img src="../img/214.png" alt="购物车"/></br></p>
            <p>此页面的详细介绍：【<span style="color:red">这几个功能在任务5中实现</span>】</br> 1、继续买，表示回到图书选购页面。</br> 2、删除功能，可以删除选中的一或多个购物条目。</br> 3、数量修改功能，数据可以添加或减少，但不能为负数。</br> 4、结算功能，进入到结束页面，并把购物车中的数据传递到下一个页面。</br></p>
          </div>
          <div class="content-nav content-nav-bottom">
            <a class="prev-page" href="Day03.html">
            <i class="fa fa-angle-left"></i>
            <span class="number">3.</span>
            Day03
            </a>
            <a class="next-page" href="Day05.html">
            <span class="number">5.</span>
            Day05
            <i class="fa fa-angle-right"></i>
            </a>
          </div>
          <div class="footer">
            <p class="credit text-muted">Powered by <a href="https://github.com/kobo/gaiden">Gaiden</a></p>
          </div>
        </div>
      </div>
    </div>
    <script src="js\jquery-2.1.1.min.js"></script>
    <script src="js\highlight.js"></script>
    <script src="js\application.js"></script>
    <script src="js\my.js"></script>
  </body>
</html>
